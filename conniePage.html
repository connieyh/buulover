<!DOCTYPE html>
<html>
<head>
	<!-- <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script> -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" href="index.css">
	<script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
	
</head>
<body>
	<div id="alert-area">
		<div id="empty-input-alert" class="alert alert-warning alert-dismissible" role="alert">
	  		<strong>Yo!</strong> You haven't entered anything!
		</div>
		<div id="wrong-input-alert" class="alert alert-danger" role="alert">
	  		<span class="sr-only">Error:</span>
			<strong>Hey!</strong> You have to enter a valid url address
		</div>
	</div>
	<div class="shareForm">
		<h4 class="shareForm-title">Share sth with David</h4>
		<input type="text" id="shareUrl">
		<button id="shareBtn" class="btn btn-primary">
			<span>Share!</span>
		</button>
	</div>
	<div id="url-view-area" style="display:none">
		<h5>David has shared ...</h5>
		<ul id="url-list" style="list-style-type:none">
		</ul>
	</div>
	<script src='index.js'></script>
	<script>
		// var btnConnie = document.getElementsByClassName('btn-connie');
		var $els = captureEl();
		var $input = $els.input;
		var $form = $els.form;
		var $shareBtn = $els.shareBtn;
		
		$shareBtn.addEventListener('click', function() {
			var inputText = $input.value;
			var $emptyAlert = document.getElementById('empty-input-alert');
			var $wrongAlert = document.getElementById('wrong-input-alert');
			if (!inputText) {
				if ($wrongAlert.style.display == 'block') {
					$wrongAlert.style.display = 'none';
				}
				$emptyAlert.style.display = 'block';
				// alert("Please enter a valid link");
			} else if (!isValidUrl(inputText)){
				if ($emptyAlert.style.display == 'block') {
					$emptyAlert.style.display = 'none';
				}
				$wrongAlert.style.display = 'block';
				// alert("Please enter a format valid link");
			} else {

				var davidDB = new Firebase("https://blinding-fire-4757.firebaseio.com/David");
				davidDB.push({
					// title: "Hello World II!",
				  	url: inputText,
		  	// 		location: {
		   //  			city: "San Francisco",
		   //  			state: "California",
		   //  			zip: 94103
		  	// 		}
				});
				reset($input);
				
				if ($emptyAlert.style.display == 'block') {
					$emptyAlert.style.display = 'none';
				} else if ($wrongAlert.style.display == 'block') {
					$wrongAlert.style.display = 'none';
				}
				
			}
			console.log(hasOneAlert);
		});

		var hasData = false;
		var $urlArea=  document.getElementById('url-view-area');

		var connieDB = new Firebase("https://blinding-fire-4757.firebaseio.com/Connie");

		connieDB.on('child_added', function(snapshot) {
			var message = snapshot.val();
			console.log(message.url);
			if (!hasData && message) {
				hasData = true;
				$urlArea.style.display = 'block';
				$urlArea.style.textAlign = 'center';
				$urlArea.style.marginTop = '8em';
			}
			appendList(message.url);
			
		});

		var $urlList= document.getElementById('url-list')
		function appendList(url) {
			var list = document.createElement('li');
			var anchor = document.createElement('a');
			var t = document.createTextNode(url);
			anchor.appendChild(t);
			anchor.href = url;
			anchor.target = "_blank";
			list.appendChild(anchor);
			$urlList.appendChild(list);
		}

	</script>
</body>

</html>